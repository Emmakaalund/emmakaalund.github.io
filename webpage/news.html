<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
</head>

<body data-title="News">
    <main>
        <header>
            <div id="header-placeholder"></div>
            <div class="news-text-container">
                <h1>News</h1>
            </div>
        </header>
        <div class="news-columns-wrapper">
            <div class="news-column" id="publications-column">
                <h2>Publications</h2>
                <div class="news-items" id="publications-list">
                    <!-- News items will be inserted here by JS -->
                </div>
                <div class="pagination" id="publications-pagination"></div>
            </div>
            <div class="news-column" id="activities-column">
                <h2>Activities</h2>
                <div class="news-items" id="activities-list">
                    <!-- News items will be inserted here by JS -->
                </div>
                <div class="pagination" id="activities-pagination"></div>
            </div>
        </div>
    </main>
    <footer></footer>
    <script>
        // Load the header
        fetch('./header.html')
            .then(res => res.text())
            .then(html => {
                const headerPlaceholder = document.querySelector('#header-placeholder');
                headerPlaceholder.innerHTML = html;

                // ðŸ”¥ This executes any <script> inside the fetched HTML
                const scripts = headerPlaceholder.querySelectorAll('script');
                scripts.forEach((script) => {
                    const newScript = document.createElement('script');
                    newScript.text = script.textContent;
                    document.body.appendChild(newScript);
                });
            });

        fetch('footer.html')
            .then(response => response.text())
            .then(data => {
                document.querySelector('footer').innerHTML = data;
            });
        // Set the document title
        document.title = document.body.getAttribute('data-title') + ' | PADME';

        // Example news data
        const publications = [
            { title: "Publication 1", content: "Summary of publication 1." },
            { title: "Publication 2", content: "Summary of publication 2." },
            { title: "Publication 3", content: "Summary of publication 3." },
            { title: "Publication 4", content: "Summary of publication 4." }
        ];
        const activities = [
            { title: "Activity 1", content: "Summary of activity 1." },
            { title: "Activity 2", content: "Summary of activity 2." },
            { title: "Activity 3", content: "Summary of activity 3." },
            { title: "Activity 4", content: "Summary of activity 4." }
        ];

        function renderNews(list, containerId, page, perPage) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            const start = (page - 1) * perPage;
            const end = start + perPage;
            list.slice(start, end).forEach(item => {
                const div = document.createElement('div');
                div.className = 'news-item';
                div.innerHTML = `<h3>${item.title}</h3><p>${item.content}</p>`;
                container.appendChild(div);
            });
        }

        function renderPagination(list, paginationId, currentPage, perPage, onPageChange) {
            const totalPages = Math.ceil(list.length / perPage);
            const pagination = document.getElementById(paginationId);
            pagination.innerHTML = '';
            if (totalPages <= 1) return;
            for (let i = 1; i <= totalPages; i++) {
                const btn = document.createElement('button');
                btn.textContent = i;
                btn.className = i === currentPage ? 'active' : '';
                btn.onclick = () => onPageChange(i);
                pagination.appendChild(btn);
            }
        }

        // Pagination state
        let publicationsPage = 1;
        let activitiesPage = 1;
        const perPage = 3;

        function updatePublications(page) {
            publicationsPage = page;
            renderNews(publications, 'publications-list', publicationsPage, perPage);
            renderPagination(publications, 'publications-pagination', publicationsPage, perPage, updatePublications);
        }
        function updateActivities(page) {
            activitiesPage = page;
            renderNews(activities, 'activities-list', activitiesPage, perPage);
            renderPagination(activities, 'activities-pagination', activitiesPage, perPage, updateActivities);
        }

        // Initial render
        updatePublications(1);
        updateActivities(1);
    </script>
</body>
</html>